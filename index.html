<!DOCTYPE html>
<html>
    <head>
        <title>Sensor Test</title>
        <meta name="viewpoint" content="width=device-width">
    </head>

    <body>

    <p> x = <span id="x"> </span></p>
    <p> y = <span id="y"> </span></p>
    <p> z = <span id="z"> </span></p>

    <script>
        /*
        let magSensor = new Magnetometer({frequency: 60});

        magSensor.addEventListener('reading', e => {
            console.log("Magnetic field along the X-axis " + magSensor.x);
            console.log("Magnetic field along the Y-axis " + magSensor.y);
            console.log("Magnetic field along the Z-axis " + magSensor.z);
        });
        magSensor.addEventListener('error', event => {
            console.log(event.error.name, event.error.message);
        });
        magSensor.start();

        window.addEventListener('reading', e => {
            document.getElementById("x").innerHTML = magSensor.x.toFixed(3);
            document.getElementById("y").innerHTML = magSensor.y.toFixed(3);
            document.getElementById("z").innerHTML = magSensor.z.toFixed(3);
        });
        */

        /*
        const sensor = new Magnetometer();
        sensor.start();

        sensor.addEventListener('activate', () ={
            console.log('Ready to report readings');
        });
        sensor.addEventListener('error', error => {
            console.error(error);
        });
        */
        navigator.permissions.query({name: 'magnetometer'})
            .then((result) => {
                if (result.state === 'granted') {
                    console.log('You can use Magnetometer');
                } else if (result.state === 'denied') {
                    console.log('You cannot use Magnetometer.');
                } else if (result.state === 'prompt') {
                    console.log('You need the permission to use Magnetometer.');
                }

                const sensor = new Magnetometer();

                sensor.addEventListener('activate', (event) => {
                    console.log('Magnetometer was activated.');
                });

                window.addEventListener('reading', function(event) {
                    document.getElementById("x").innerHTML = sensor.x.toFixed(3);
                    document.getElementById("y").innerHTML = sensor.y.toFixed(3);
                    document.getElementById("z").innerHTML = sensor.z.toFixed(3);
                });

                sensor.addEventListener('error', (event) => {
                    console.log(event.error);
                });

                sensor.start();
            });
    </script>

    </body>
</html>


